{% extends 'base.html' %}
{% block content %}
<h2>Encrypt &amp; Hide</h2>

<form method="post" enctype="multipart/form-data">
  <label>Secret message (text)</label>
  <textarea name="secret" rows="6" required></textarea>

  <label>Recipient RSA public key (PEM)</label>
  <textarea name="recipient_pub" rows="8" placeholder="-----BEGIN PUBLIC KEY-----..." required></textarea>

  <label>Choose carrier file</label>
  <!-- Allow selecting PNG / JPG / JPEG / BMP explicitly -->
  <input type="file" name="carrier" accept=".png,.jpg,.jpeg,.bmp,.wav,.txt,.avi" required>
  <small style="display:block;margin-bottom:10px;color:#888;">
    For images you can upload PNG, JPG, JPEG or BMP.  
    <strong>Note:</strong> For security and correct LSB steganography, the output stego image
    will always be saved as <code>.png</code>.
  </small>

  <label>Carrier type</label>
  <select name="carrier_type">
    <option value="image">Image (PNG/JPG/JPEG/BMP â€“ output PNG)</option>
    <option value="audio">Audio (WAV)</option>
    <option value="text">Text (TXT)</option>
    <option value="video">Video (AVI)</option>
  </select>

  <label>LSB bits (1 recommended)</label>
  <input type="number" name="lsb_bits" min="1" max="2" value="1">

  <label>
    <input type="checkbox" name="compress">
    Compress message (zlib)
  </label>

  <button type="submit">Encrypt &amp; Download stego file</button>
</form>
{% endblock %}
