{% extends 'base.html' %}
{% block content %}

<h2>Extract & Decrypt</h2>

<form method="post" enctype="multipart/form-data">

  <label>Carrier file (image/audio/text/video)</label>
  <input type="file" name="carrier" accept=".png,.jpg,.jpeg,.bmp,.wav,.txt,.avi" required>
  <small style="display:block;margin-bottom:10px;color:#888;">
    For images, upload the <strong>stego PNG</strong> you got after encryption.
    (JPG inputs are converted to PNG during encryption).
  </small>

  <label>Carrier type</label>
  <select name="carrier_type">
    <option value="image">Image (PNG/JPG/JPEG/BMP â€“ stego must be PNG)</option>
    <option value="audio">Audio (WAV)</option>
    <option value="text">Text (TXT)</option>
    <option value="video">Video (AVI)</option>
  </select>

  <label>LSB bits (same value used during encryption)</label>
  <input type="number" name="lsb_bits" min="1" max="2" value="1">

  <label>Your RSA Private Key (PEM)</label>
  <textarea name="private_key" rows="10" placeholder="-----BEGIN PRIVATE KEY-----..." required></textarea>
   	
  <button type="submit">Extract & Decrypt</button>
</form>

{% if result %}
  <h3>Recovered Message</h3>
  <pre>{{ result }}</pre>
{% endif %}

{% endblock %}
