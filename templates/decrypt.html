{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>Extract & Decrypt</h2>
  <form method="post" enctype="multipart/form-data" class="form">
    <label>Carrier with hidden data</label>
    <input type="file" name="carrier" required>

    <label>Carrier type</label>
    <select name="carrier_type">
      <option value="image">Image (PNG/JPEG/BMP)</option>
      <option value="audio">Audio (WAV)</option>
      <option value="text">Text (TXT)</option>
      <option value="video">Video (AVI)</option>
    </select>

    <label>LSB bits (used when embedding)</label>
    <input type="number" name="lsb_bits" min="1" max="2" value="1">

    <label>Recipient RSA private key (PEM)</label>
    <textarea name="private_key" rows="10" placeholder="-----BEGIN PRIVATE KEY-----." required></textarea>

    <label>Private key passphrase (if PEM is encrypted)</label>
    <input type="password" name="passphrase" placeholder="Enter passphrase (leave empty if not encrypted)">

    <button type="submit" class="btn">Extract & Decrypt</button>
  </form>

  {% if result %}
    <h3>Recovered message</h3>
    <pre>{{ result }}</pre>
  {% endif %}
</section>
{% endblock %}