{% extends 'base.html' %}
{% block content %}
<center>
  <h2>Generate RSA Key Pair</h2>
</center>


<form method="post">
  <center>
<label>Passphrase for private key (optional)</label>
  </center>
    <input type="password" name="passphrase" placeholder="Enter passphrase (optional)">
    <center>
  <button type="submit">Generate Keys</button>
    </center>
</form>


{% if priv_pem %}
<center>
</center>

  <h3>Private Key (PEM)</h3>
  <textarea id="priv_pem" rows="12">{{ priv_pem }}</textarea>
  <button onclick="downloadText('priv_pem','private_key.pem')">Download Private Key</button>

  <h3>Public Key (PEM)</h3>
  <textarea id="pub_pem" rows="8">{{ pub_pem }}</textarea>
  <button onclick="downloadText('pub_pem','public_key.pem')">Download Public Key</button>

  <p style="margin-top:10px;color:#777;">
    ⚠️ Keep your private key safe.  
    Anyone with your private key can decrypt your hidden messages.
  </p>
{% endif %}

{% endblock %}
